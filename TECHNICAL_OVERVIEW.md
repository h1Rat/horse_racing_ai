# 競馬AI予測システム - 技術概要

## システムアーキテクチャ

本システムは機械学習（LightGBM）を活用した競馬の着順予測システムです。以下のモジュール構成で実装されています。

```
portfolio_horse_racing_ai/
├── src/
│   ├── models/                 # 機械学習モデル
│   │   └── lightgbm_predictor.py
│   ├── data_processing/        # データ前処理
│   │   └── feature_engineering.py  
│   ├── scrapers/               # データ収集
│   │   └── data_collector.py
│   └── utils/                  # ユーティリティ
│       └── data_validator.py
├── config/                     # 設定ファイル
│   └── model_config_sample.json
```

## 技術仕様

### 機械学習アルゴリズム
- **アルゴリズム**: LightGBM (Gradient Boosting Decision Tree)
- **問題設定**: バイナリ分類（1着予測）
- **評価指標**: Log Loss, Accuracy, Precision, Recall, F1-Score

### 特徴量エンジニアリング

#### 1. 基本特徴量
- 馬の基本情報（年齢、性別、馬体重）
- レース条件（距離、競馬場、馬場状態）
- 騎手・調教師情報

#### 2. 過去成績特徴量
- 過去3走の着順・角順位・上がり順位
- 人気と着順の乖離度（人気裏切り指数）
- 距離変化・頭数変化

#### 3. 指数系特徴量
- 先行指数、ペース指数、上がり指数、スピード指数
- レース毎偏差値標準化（平均50、標準偏差10）

#### 4. 組み合わせ特徴量
- 競馬場×距離の組み合わせ
- 月×性別の組み合わせ
- クラス進展パターン

### データ前処理フロー

1. **データ検証**
   - 不正着順（「外」「消」等）の除去
   - データ型統一
   - 外れ値検出・除去

2. **特徴量生成**
   - 時系列特徴量の抽出
   - 過去成績の合成特徴量
   - 相互作用特徴量

3. **標準化**
   - レース毎偏差値計算
   - カテゴリカル変数のエンコーディング

### モデル最適化

#### ハイパーパラメータ
- 競馬場・レースタイプ別に最適化
- Optuna使用による自動チューニング
- 交差検証による性能評価

#### 主要パラメータ例
```json
{
  "objective": "binary",
  "metric": "binary_logloss", 
  "num_leaves": 31,
  "learning_rate": 0.05,
  "feature_fraction": 0.9,
  "bagging_fraction": 0.8
}
```

## パフォーマンス指標

### 予測精度
- **適中率**: 競馬場・条件別に異なる
- **投資効率**: オッズ×適中率による評価
- **安定性**: 長期運用での成績安定性

### システム性能
- **予測速度**: 1レース（16頭）約0.1秒
- **データ処理**: 10万レコード/分
- **メモリ使用量**: 最大2GB

## セキュリティ・コンプライアンス

### データ保護
- 公開情報のみ使用
- 個人情報の適切な匿名化
- 機密情報のマスキング処理

### 著作権対応
- 独自の特徴量エンジニアリング
- オープンソースライブラリ使用
- サードパーティデータの適切な引用

## 技術的課題と改善案

### 現在の制限事項
1. リアルタイム予測の遅延
2. 外部要因（天候急変等）の考慮不足
3. データ収集の安定性

### 改善計画
1. **モデル高度化**
   - ディープラーニング手法の導入
   - アンサンブル学習の活用
   - 時系列予測モデルの統合

2. **システム改善**
   - リアルタイム処理の最適化
   - クラウド基盤への移行
   - API化による外部連携

3. **運用改善**
   - 自動再学習システム
   - 異常検知機能
   - パフォーマンス監視

## 今後の展開

### 短期目標（3ヶ月）
- 予測精度の向上（5%改善）
- レスポンス時間短縮（50%削減）
- ユーザーインターフェース改善

### 中期目標（1年）
- 多変量予測（複勝・馬連等）
- リアルタイム分析機能
- 外部データソース統合

### 長期目標（2年以上）
- 国際レース対応
- モバイルアプリ化
- 商用サービス化検討

---

*このドキュメントは技術ポートフォリオ用であり、実装の詳細は一部マスキングされています。* 